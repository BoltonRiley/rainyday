<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Rain Checker</title>
<style>
    body {
        background: black;
        color: white;
        font-family: sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        text-align: center;
        padding: 20px;
    }
    button {
        padding: 10px 20px;
        font-size: 18px;
        margin-top: 20px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }
</style>
</head>
<body>

<div id="output">Checking weatherâ€¦</div>

<script>
// Melbourne fallback coordinates
const MELBOURNE = { lat: -37.8136, lon: 144.9631 };

function checkRain(lat, lon) {
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=precipitation`;

    fetch(url)
        .then(res => res.json())
        .then(data => {
            const rain = data?.current?.precipitation ?? 0;

            if (rain > 0) {
                document.getElementById("output").innerHTML = `
                    <h1>Welcome to rainy day</h1>
                    <button onclick="alert('Game starting...')">Play</button>
                `;
            } else {
                document.getElementById("output").textContent =
                    "The storm is growing, but you cannot enter until the skies open!";
            }
        })
        .catch(() => {
            document.getElementById("output").textContent =
                "Error checking weather.";
        });
}

function getLocation() {
    if (!navigator.geolocation) {
        checkRain(MELBOURNE.lat, MELBOURNE.lon);
        return;
    }

    navigator.geolocation.getCurrentPosition(
        (pos) => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            checkRain(lat, lon);
        },
        () => {
            checkRain(MELBOURNE.lat, MELBOURNE.lon);
        }
    );
}

getLocation();
</script>

</body>
</html>
